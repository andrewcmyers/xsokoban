############################################################
# C compiler
############################################################
CC = @CC@

############################################################
# C compiler flags
############################################################
#
OPTIMIZER = -O -DNDEBUG
#OPTIMIZER = -g -UNDEBUG
INCS = @INCS@
WARN = @WARN@
LIBS = @LIBS@
DEFS =
SUPERUSER = @SUPERUSER@

############################################################
# Other programs
############################################################
INSTALL = @INSTALL@ -o $(SUPERUSER)
CP = /bin/cp
CHOWN = /bin/chown
MKDIR = /bin/mkdir

############################################################
# Where to install the executable, data files, and man page
############################################################
INSTALL_BIN = /usr/local/bin
INSTALL_LIB = /usr/local/lib/xsokoban
INSTALL_MAN = /usr/local/man/man1

##### Nothing from here on should need customization ######################

CFLAGS = $(OPTIMIZER) $(WARN) $(INCS) $(DEFS)
OBJECTS = display.o main.o resources.o play.o score.o screen.o save.o \
	  scoredisp.o qtelnet.o

xsokoban: $(OBJECTS)
	$(CC) $(CFLAGS) -o xsokoban $(OBJECTS) $(LIBS)

clean:
	rm -f $(OBJECTS)

clobber: clean
	rm -f xsokoban

install: xsokoban
	$(INSTALL) -s -o $(SUPERUSER) -m 4755 xsokoban $(INSTALL_BIN)/xsokoban
	$(INSTALL) xsokoban.man $(INSTALL_MAN)/xsokoban.1
	-$(MKDIR) $(INSTALL_LIB)
	-$(MKDIR) $(INSTALL_LIB)/scores
	-$(MKDIR) $(INSTALL_LIB)/saves
	-$(MKDIR) $(INSTALL_LIB)/screens
	$(CP) screens/screen.* $(INSTALL_LIB)/screens
	$(CP) -r bitmaps $(INSTALL_LIB)
	$(CHOWN) $(SUPERUSER) $(INSTALL_LIB)/scores
	@echo "Remember to run 'xsokoban -c' if you have no score file yet."

# DO NOT DELETE THIS LINE -- make depend depends on it.

display.o: config_local.h globals.h config.h defaults.h help.h
main.o: externs.h config_local.h globals.h config.h options.h errors.h
play.o: externs.h config_local.h globals.h config.h
resources.o: externs.h config_local.h globals.h config.h defaults.h
save.o: config_local.h externs.h globals.h config.h
score.o: config_local.h externs.h globals.h config.h
scoredisp.o: externs.h config_local.h globals.h config.h defaults.h
screen.o: externs.h config_local.h globals.h config.h
